package com.mx.pmx.pmi.sad.generadorDocx.integrador.serviceImpl;

public interface PeopleSoftQuery {

	public static String queryPeopleEmp="SELECT DISTINCT"
			+ " POS.POSITION_NBR AS Posicion "
			+ ", POS.Nombre_Posicion "
			+ ", EMP.Empleado "
			+ ", EMP.Perfil "
			+ ", EMP.Nombre "
			+ ", EMP.Apellidos "
			+ ", EMP.Puesto "
			+ ", EMP.Cumpleanios "
			+ ", EMP.Correo "
			+ ", EMP.Usuario "
			+ ", EMP.Departamento "
			+ ", EMP.Area "
			+ ", POS.REPORTS_TO AS Posicion_Reporta "
			+ ", JEF.Administrador "
			+ "FROM "
			+ "(SELECT A.POSITION_NBR, "
			+ "B.DESCR AS Nombre_Posicion, "
			+ "A.REPORTS_TO "
			+ "FROM PS_POSITION_DATA A, PS_POSN_DATA_LANG B WHERE A. EFFDT = (SELECT MAX(A1.EFFDT) FROM PS_POSITION_DATA A1"
			+ " WHERE A1.POSITION_NBR = A.POSITION_NBR"
			+ " AND A1.EFFDT <= GETDATE()) AND A.EFF_STATUS = 'A' "
			+ "AND A.POSN_STATUS = 'A' "
			+ "AND A.POSITION_NBR = B.POSITION_NBR "
			+ "AND A.EFFDT = B.EFFDT) POS "
			+ "LEFT OUTER JOIN "
			+ "(SELECT J.EMPLID AS Empleado, "
			+ "USR.OPRID AS Perfil, "
			+ "K.FIRST_NAME AS Nombre, "
			+ " RTRIM(K.LAST_NAME) + ' ' + RTRIM(K.SECOND_LAST_NAME) AS Apellidos, "
			+ "L.DESCR AS Puesto, "
			+ "CONVERT(VARCHAR(10), P.BIRTHDATE, 111) AS Cumpleanios, "
			+ "ISNULL(RTRIM(EA.EMAIL_ADDR), ' ') AS Correo, "
			+ "CASE WHEN EA.EMAIL_ADDR IS NULL THEN ' ' ELSE SUBSTRING(EA.EMAIL_ADDR, 1, PATINDEX('%@%', EA.EMAIL_ADDR) -1) END AS Usuario, "
			+ "M.DESCR AS Departamento, "
			+ "ISNULL(RTRIM(Q.DESCR100_2_GER), ' ') AS Area, "
			+ "J.POSITION_NBR "
			+ "FROM PS_JOB J LEFT OUTER JOIN PSOPRDEFN AS USR ON J.EMPLID = USR.EMPLID AND USR.OPRTYPE = 1 "
			+ " LEFT OUTER JOIN PS_NAMES AS K ON J.EMPLID = K.EMPLID"
			+ " AND K.EFFDT = (SELECT MAX(K1.EFFDT) FROM PS_NAMES K1 "
			+ "WHERE K1.EMPLID = K.EMPLID) LEFT OUTER JOIN PS_JOBCODE_LANG AS L ON J.JOBCODE = L.JOBCODE "
			+ "AND J.SETID_JOBCODE = L.SETID "
			+ "AND L.EFFDT = (SELECT MAX(L1.EFFDT) FROM PS_JOBCODE_LANG L1 "
			+ "WHERE L1.SETID = L.SETID "
			+ "AND L1.JOBCODE = L.JOBCODE) LEFT OUTER JOIN PS_DEPT_TBL AS M ON J.DEPTID = M.DEPTID "
			+ "AND J.SETID_DEPT = M.SETID "
			+ "AND M.EFFDT = (SELECT MAX(M1.EFFDT) FROM PS_DEPT_TBL M1 "
			+ "WHERE M1.SETID = M.SETID "
			+ "AND M1.DEPTID = M.DEPTID) LEFT OUTER JOIN PS_EMAIL_ADDRESSES AS EA ON J.EMPLID = EA.EMPLID "
			+ "AND EA.E_ADDR_TYPE = 'BUSN' "
			+ "LEFT OUTER JOIN PS_PERSON AS P ON J.EMPLID = P.EMPLID LEFT OUTER JOIN PS_PMI_PLANT_PERS AS Q ON J.EMPLID = Q.EMPLID WHERE J.EFFDT = (SELECT MAX(J1.EFFDT) FROM PS_JOB J1"
			+ " WHERE J1.EMPLID = J.EMPLID "
			+ "AND J1.EMPL_RCD = J.EMPL_RCD "
			+ "AND J1.EFFDT <= GETDATE()) AND J.EFFSEQ = (SELECT MAX(J2.EFFSEQ) FROM PS_JOB J2 "
			+ "WHERE J2.EMPLID = J.EMPLID "
			+ "AND J2.EMPL_RCD = J.EMPL_RCD "
			+ "AND J2.EFFDT = J.EFFDT) AND J.EMPL_STATUS = 'A' "
			+ "AND J.EMPLID NOT LIKE 'TAB%') EMP "
			+ "ON POS.POSITION_NBR = EMP.POSITION_NBR "
			+ "LEFT OUTER JOIN "
			+ "(SELECT X.EMPLID AS Administrador, "
			+ "X.POSITION_NBR "
			+ "FROM PS_JOB X "
			+ "WHERE X.EFFDT = (SELECT MAX(X1.EFFDT) FROM PS_JOB X1 "
			+ "WHERE X1.EMPLID = X.EMPLID "
			+ "AND X1.EMPL_RCD = X.EMPL_RCD "
			+ "AND X1.EFFDT <= GETDATE()) AND X.EFFSEQ = (SELECT MAX(X2.EFFSEQ) FROM PS_JOB X2 "
			+ "WHERE X2.EMPLID = X.EMPLID "
			+ "AND X2.EMPL_RCD = X.EMPL_RCD"
			+ " AND X2.EFFDT = X.EFFDT) AND X.EMPL_STATUS = 'A' "
			+ "AND X.EMPLID NOT LIKE 'TAB%' "
			+ "AND X.POSITION_NBR != '') JEF "
			+ "ON JEF.POSITION_NBR = POS.REPORTS_TO "
			+ "WHERE  EMP.Perfil like ";
	
	public static String queryPeopleDir="SELECT DISTINCT"
			+ " POS.POSITION_NBR AS Posicion "
			+ ", POS.Nombre_Posicion "
			+ ", EMP.Empleado "
			+ ", EMP.Perfil "
			+ ", EMP.Nombre "
			+ ", EMP.Apellidos "
			+ ", EMP.Puesto "
			+ ", EMP.Cumpleanios "
			+ ", EMP.Correo "
			+ ", EMP.Usuario "
			+ ", EMP.Departamento "
			+ ", EMP.Area "
			+ ", POS.REPORTS_TO AS Posicion_Reporta "
			+ ", JEF.Administrador "
			+ "FROM "
			+ "(SELECT A.POSITION_NBR, "
			+ "B.DESCR AS Nombre_Posicion, "
			+ "A.REPORTS_TO "
			+ "FROM PS_POSITION_DATA A, PS_POSN_DATA_LANG B WHERE A. EFFDT = (SELECT MAX(A1.EFFDT) FROM PS_POSITION_DATA A1"
			+ " WHERE A1.POSITION_NBR = A.POSITION_NBR"
			+ " AND A1.EFFDT <= GETDATE()) AND A.EFF_STATUS = 'A' "
			+ "AND A.POSN_STATUS = 'A' "
			+ "AND A.POSITION_NBR = B.POSITION_NBR "
			+ "AND A.EFFDT = B.EFFDT) POS "
			+ "LEFT OUTER JOIN "
			+ "(SELECT J.EMPLID AS Empleado, "
			+ "USR.OPRID AS Perfil, "
			+ "K.FIRST_NAME AS Nombre, "
			+ " RTRIM(K.LAST_NAME) + ' ' + RTRIM(K.SECOND_LAST_NAME) AS Apellidos, "
			+ "L.DESCR AS Puesto, "
			+ "CONVERT(VARCHAR(10), P.BIRTHDATE, 111) AS Cumpleanios, "
			+ "ISNULL(RTRIM(EA.EMAIL_ADDR), ' ') AS Correo, "
			+ "CASE WHEN EA.EMAIL_ADDR IS NULL THEN ' ' ELSE SUBSTRING(EA.EMAIL_ADDR, 1, PATINDEX('%@%', EA.EMAIL_ADDR) -1) END AS Usuario, "
			+ "M.DESCR AS Departamento, "
			+ "ISNULL(RTRIM(Q.DESCR100_2_GER), ' ') AS Area, "
			+ "J.POSITION_NBR "
			+ "FROM PS_JOB J LEFT OUTER JOIN PSOPRDEFN AS USR ON J.EMPLID = USR.EMPLID AND USR.OPRTYPE = 1 "
			+ " LEFT OUTER JOIN PS_NAMES AS K ON J.EMPLID = K.EMPLID"
			+ " AND K.EFFDT = (SELECT MAX(K1.EFFDT) FROM PS_NAMES K1 "
			+ "WHERE K1.EMPLID = K.EMPLID) LEFT OUTER JOIN PS_JOBCODE_LANG AS L ON J.JOBCODE = L.JOBCODE "
			+ "AND J.SETID_JOBCODE = L.SETID "
			+ "AND L.EFFDT = (SELECT MAX(L1.EFFDT) FROM PS_JOBCODE_LANG L1 "
			+ "WHERE L1.SETID = L.SETID "
			+ "AND L1.JOBCODE = L.JOBCODE) LEFT OUTER JOIN PS_DEPT_TBL AS M ON J.DEPTID = M.DEPTID "
			+ "AND J.SETID_DEPT = M.SETID "
			+ "AND M.EFFDT = (SELECT MAX(M1.EFFDT) FROM PS_DEPT_TBL M1 "
			+ "WHERE M1.SETID = M.SETID "
			+ "AND M1.DEPTID = M.DEPTID) LEFT OUTER JOIN PS_EMAIL_ADDRESSES AS EA ON J.EMPLID = EA.EMPLID "
			+ "AND EA.E_ADDR_TYPE = 'BUSN' "
			+ "LEFT OUTER JOIN PS_PERSON AS P ON J.EMPLID = P.EMPLID LEFT OUTER JOIN PS_PMI_PLANT_PERS AS Q ON J.EMPLID = Q.EMPLID WHERE J.EFFDT = (SELECT MAX(J1.EFFDT) FROM PS_JOB J1"
			+ " WHERE J1.EMPLID = J.EMPLID "
			+ "AND J1.EMPL_RCD = J.EMPL_RCD "
			+ "AND J1.EFFDT <= GETDATE()) AND J.EFFSEQ = (SELECT MAX(J2.EFFSEQ) FROM PS_JOB J2 "
			+ "WHERE J2.EMPLID = J.EMPLID "
			+ "AND J2.EMPL_RCD = J.EMPL_RCD "
			+ "AND J2.EFFDT = J.EFFDT) AND J.EMPL_STATUS = 'A' "
			+ "AND J.EMPLID NOT LIKE 'TAB%') EMP "
			+ "ON POS.POSITION_NBR = EMP.POSITION_NBR "
			+ "LEFT OUTER JOIN "
			+ "(SELECT X.EMPLID AS Administrador, "
			+ "X.POSITION_NBR "
			+ "FROM PS_JOB X "
			+ "WHERE X.EFFDT = (SELECT MAX(X1.EFFDT) FROM PS_JOB X1 "
			+ "WHERE X1.EMPLID = X.EMPLID "
			+ "AND X1.EMPL_RCD = X.EMPL_RCD "
			+ "AND X1.EFFDT <= GETDATE()) AND X.EFFSEQ = (SELECT MAX(X2.EFFSEQ) FROM PS_JOB X2 "
			+ "WHERE X2.EMPLID = X.EMPLID "
			+ "AND X2.EMPL_RCD = X.EMPL_RCD"
			+ " AND X2.EFFDT = X.EFFDT) AND X.EMPL_STATUS = 'A' "
			+ "AND X.EMPLID NOT LIKE 'TAB%' "
			+ "AND X.POSITION_NBR != '') JEF "
			+ "ON JEF.POSITION_NBR = POS.REPORTS_TO "
			+ "where Puesto like 'DIR%' "
			+ "AND Area like ";
}
